<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>결제 (데모) - Anon 스토어</title>
  <style>
    :root{ --bg:#ffffff; --text:#1f2937; --muted:#6b7280; --brand:#111827; --line:#e5e7eb; --ok:#10b981 }
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,"Apple SD Gothic Neo","Noto Sans KR",sans-serif; margin:0; background:var(--bg); color:var(--text);} 
    header{border-bottom:1px solid var(--line); position:sticky; top:0; background:#fff; z-index:10}
    .wrap{max-width:1100px; margin:0 auto; padding:0 16px;}
    .nav{display:flex; align-items:center; justify-content:space-between; padding:14px 0}
    .logo a{color:var(--brand); font-weight:700; text-decoration:none; font-size:1.1rem}
    main{padding:24px 0}
    h1{font-size:1.5rem; margin:0 0 16px}
    .grid{display:grid; grid-template-columns:1fr; gap:16px}
    @media(min-width:900px){ .grid{ grid-template-columns:1.5fr 1fr } }
    .card{border:1px solid var(--line); border-radius:10px; padding:14px}
    .summary-row{display:flex; justify-content:space-between; padding:8px 0; font-size:.95rem}
    .summary-row.total{font-weight:700; border-top:1px dashed var(--line); margin-top:6px; padding-top:12px}
    .btn{appearance:none; border:1px solid var(--line); background:#fff; border-radius:8px; padding:10px 14px; cursor:pointer}
    .success{border:1px solid #d1fae5; background:#ecfdf5; color:#064e3b; border-radius:10px; padding:14px}
    .demo-badge{font-size:.75rem; color:#6b7280}
  </style>
</head>
<body>
<header>
  <div class="wrap nav">
    <div class="logo"><a href="./index.html">Anon 스토어</a> <span class="demo-badge">(데모)</span></div>
    <div><a href="./cart.html">장바구니</a></div>
  </div>
</header>
<main class="wrap">
  <h1>결제</h1>
  <p class="demo-badge">* 이 페이지는 더미(데모) 모드로, 장바구니 상품을 자동 결제 완료 상태로 표시합니다.</p>

  <div class="grid" id="checkoutGrid" style="display:none">
    <aside class="card" id="summary">
      <h2 style="margin-top:0">주문 요약</h2>
      <div id="items"></div>
      <div class="summary-row"><span>상품 소계</span><strong id="subtotal">₩0</strong></div>
      <div class="summary-row"><span>배송비</span><span id="shipping">₩0</span></div>
      <div class="summary-row"><span>할인</span><span id="discount">-₩0</span></div>
      <div class="summary-row total"><span>결제 금액</span><strong id="grandTotal">₩0</strong></div>
      <div style="margin-top:12px"><button class="btn" id="simulatePay">결제 시뮬레이션 실행</button></div>
    </aside>
  </div>

  <section id="successBox" class="success" style="display:none"></section>
</main>
<footer>
  <div class="wrap">© Anon. 모든 권리 보유.</div>
</footer>
<script>
  const DEMO_MODE = true; // ✅ 데모 모드
  const CART_KEY = 'anon_cart_v1';
  const fmtKRW = v => new Intl.NumberFormat('ko-KR',{style:'currency', currency:'KRW'}).format(Math.max(0, v||0));
  const readCart = () => { try{ return JSON.parse(localStorage.getItem(CART_KEY))||[] }catch(e){ return [] } };

  function renderSummary(items){
    const itemsBox = document.getElementById('items');
    itemsBox.innerHTML='';
    let subtotal = 0;
    items.forEach(i=>{
      const qty = Number(i.qty||1), price = Number(i.price||0);
      subtotal += qty*price;
      const line = document.createElement('div');
      line.style.display='flex'; line.style.justifyContent='space-between'; line.style.padding='6px 0';
      line.innerHTML = `<div style="color:#6b7280">${i.title||'상품'} x ${qty}</div><div><strong>${fmtKRW(qty*price)}</strong></div>`;
      itemsBox.appendChild(line);
    });
    const shipping = subtotal>=55000?0:3000;
    const discount = 0;
    const total = subtotal + shipping - discount;
    document.getElementById('subtotal').textContent = fmtKRW(subtotal);
    document.getElementById('shipping').textContent = fmtKRW(shipping);
    document.getElementById('discount').textContent = '-'+fmtKRW(discount).replace('₩','');
    document.getElementById('grandTotal').textContent = fmtKRW(total);
    return {subtotal, shipping, discount, total};
  }

  function showSuccess(name, method, total){
    const s = document.getElementById('successBox');
    s.style.display='block';
    s.innerHTML = `<h2 style=\"margin-top:0\">주문 완료 (데모)</h2>
      <p><strong>${name}</strong> 님, 주문이 정상적으로 접수된 것으로 표시됩니다.</p>
      <p>결제 방법: <strong>${method}</strong> · 결제 금액: <strong>${fmtKRW(total)}</strong></p>
      <p class=\"demo-badge\">* 더미 페이지로 실제 결제가 이뤄지지 않습니다.</p>
      <div style=\"display:flex; gap:8px;\">
        <button class=\"btn\" onclick=\"location.href='./index.html'\">계속 쇼핑하기</button>
        <button class=\"btn\" onclick=\"location.href='./cart.html'\">장바구니로 이동</button>
      </div>`;
  }

  function init(){
    const items = readCart();
    if(items.length===0){
      // 장바구니가 비어있으면 같은 더미 상품을 자동으로 채웁니다
      localStorage.setItem(CART_KEY, JSON.stringify([
        {title:'프리미엄 데일리 캐주얼 셔츠', price:49000, qty:1, size:'M', color:'화이트', image:'./assets/shirt.jpg'}
      ]));
    }
    document.getElementById('checkoutGrid').style.display='grid';
    const totals = renderSummary(readCart());

    // 데모: 자동 성공 표시 (3초 후)
    if(DEMO_MODE){
      setTimeout(()=> showSuccess('테스트 사용자','가상결제(데모)', totals.total), 1500);
    }

    // 버튼으로 즉시 시뮬레이션
    document.getElementById('simulatePay').addEventListener('click', ()=>{
      showSuccess('테스트 사용자','가상결제(데모)', totals.total);
    });
  }

  init();
</script>
</body>
</html>